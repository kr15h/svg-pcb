const FT230XS = {"TXD":{"shape":"M -0.03,0.0053L 0.03,0.0053L 0.03,-0.0053L -0.03,-0.0053L -0.03,0.0053","pos":[-0.11,0.08956692913385828],"layers":["F.Cu"],"index":1},"RTS":{"shape":"M -0.03,0.0053L 0.03,0.0053L 0.03,-0.0053L -0.03,-0.0053L -0.03,0.0053","pos":[-0.11,0.06397637795275592],"layers":["F.Cu"],"index":2},"VIO":{"shape":"M -0.03,0.0053L 0.03,0.0053L 0.03,-0.0053L -0.03,-0.0053L -0.03,0.0053","pos":[-0.11,0.038385826771653545],"layers":["F.Cu"],"index":3},"RXD":{"shape":"M -0.03,0.0053L 0.03,0.0053L 0.03,-0.0053L -0.03,-0.0053L -0.03,0.0053","pos":[-0.11,0.012795275590551183],"layers":["F.Cu"],"index":4},"GND1":{"shape":"M -0.03,0.0053L 0.03,0.0053L 0.03,-0.0053L -0.03,-0.0053L -0.03,0.0053","pos":[-0.11,-0.012795275590551183],"layers":["F.Cu"],"index":5},"GND2":{"shape":"M -0.03,0.0053L 0.03,0.0053L 0.03,-0.0053L -0.03,-0.0053L -0.03,0.0053","pos":[0.11,0.012795275590551183],"layers":["F.Cu"],"index":13},"CTS":{"shape":"M -0.03,0.0053L 0.03,0.0053L 0.03,-0.0053L -0.03,-0.0053L -0.03,0.0053","pos":[-0.11,-0.038385826771653545],"layers":["F.Cu"],"index":6},"CB2":{"shape":"M -0.03,0.0053L 0.03,0.0053L 0.03,-0.0053L -0.03,-0.0053L -0.03,0.0053","pos":[-0.11,-0.06397637795275592],"layers":["F.Cu"],"index":7},"USP":{"shape":"M -0.03,0.0053L 0.03,0.0053L 0.03,-0.0053L -0.03,-0.0053L -0.03,0.0053","pos":[-0.11,-0.08956692913385828],"layers":["F.Cu"],"index":8},"USM":{"shape":"M -0.03,0.0053L 0.03,0.0053L 0.03,-0.0053L -0.03,-0.0053L -0.03,0.0053","pos":[0.11,-0.08956692913385828],"layers":["F.Cu"],"index":9},"3V3":{"shape":"M -0.03,0.0053L 0.03,0.0053L 0.03,-0.0053L -0.03,-0.0053L -0.03,0.0053","pos":[0.11,-0.06397637795275592],"layers":["F.Cu"],"index":10},"RST":{"shape":"M -0.03,0.0053L 0.03,0.0053L 0.03,-0.0053L -0.03,-0.0053L -0.03,0.0053","pos":[0.11,-0.038385826771653545],"layers":["F.Cu"],"index":11},"VCC":{"shape":"M -0.03,0.0053L 0.03,0.0053L 0.03,-0.0053L -0.03,-0.0053L -0.03,0.0053","pos":[0.11,-0.012795275590551183],"layers":["F.Cu"],"index":12},"CB1":{"shape":"M -0.03,0.0053L 0.03,0.0053L 0.03,-0.0053L -0.03,-0.0053L -0.03,0.0053","pos":[0.11,0.038385826771653545],"layers":["F.Cu"],"index":14},"CB0":{"shape":"M -0.03,0.0053L 0.03,0.0053L 0.03,-0.0053L -0.03,-0.0053L -0.03,0.0053","pos":[0.11,0.06397637795275592],"layers":["F.Cu"],"index":15},"CB3":{"shape":"M -0.03,0.0053L 0.03,0.0053L 0.03,-0.0053L -0.03,-0.0053L -0.03,0.0053","pos":[0.11,0.08956692913385828],"layers":["F.Cu"],"index":16}};
const C_1206 = {"1":{"shape":"M -0.032,0.034L 0.032,0.034L 0.032,-0.034L -0.032,-0.034L -0.032,0.034","pos":[-0.06,0],"layers":["F.Cu"],"index":1},"2":{"shape":"M -0.032,0.034L 0.032,0.034L 0.032,-0.034L -0.032,-0.034L -0.032,0.034","pos":[0.06,0],"layers":["F.Cu"],"index":2}};
const USB_A_plug = {"5V":{"shape":"M -0.04999999999999999,0.02L 0.242,0.02L 0.242,-0.02L -0.04999999999999999,-0.02L -0.04999999999999999,0.02","pos":[0,0.138],"layers":["F.Cu"],"index":1},"D-":{"shape":"M -0.05,0.02L 0.202,0.02L 0.202,-0.02L -0.05,-0.02L -0.05,0.02","pos":[0,0.039],"layers":["F.Cu"],"index":2},"D+":{"shape":"M -0.05,0.02L 0.202,0.02L 0.202,-0.02L -0.05,-0.02L -0.05,0.02","pos":[0,-0.039],"layers":["F.Cu"],"index":3},"GND":{"shape":"M -0.04999999999999999,0.02L 0.242,0.02L 0.242,-0.02L -0.04999999999999999,-0.02L -0.04999999999999999,0.02","pos":[0,-0.138],"layers":["F.Cu"],"index":4}};
const R_1206 = {"1":{"shape":"M -0.032,0.034L 0.032,0.034L 0.032,-0.034L -0.032,-0.034L -0.032,0.034","pos":[-0.06,0],"layers":["F.Cu"],"index":1},"2":{"shape":"M -0.032,0.034L 0.032,0.034L 0.032,-0.034L -0.032,-0.034L -0.032,0.034","pos":[0.06,0],"layers":["F.Cu"],"index":2}};
const header_UPDI_reverse = {"UPDI":{"shape":"M -0.05,0.025L 0.05,0.025L 0.05,-0.025L -0.05,-0.025L -0.05,0.025","pos":[0,0.05],"layers":["F.Cu"],"index":1},"GND":{"shape":"M -0.05,0.025L 0.05,0.025L 0.05,-0.025L -0.05,-0.025L -0.05,0.025","pos":[0,-0.05],"layers":["F.Cu"],"index":2}};


// commands:
//  - SHIFT+ENTER: render
//  - drap & drop file: kicad import


// constants
const width = .65 // board width
const height = 1.13 // board height
const x = 1 // x origin
const y = 1 // y origin
const zt = 0 // top z
const zb = -0.06 // bottom z
const w = .0106 // thinner wire width
const w1 = .015 // thicker wire width
const mask = .004 // solder mask size
const border = 0.05 // rendering border


/* -- DECLARE_PCB -- */
let board = new PCB();

let interior = geo.translate(geo.rectangle(width, height), [x+width/2, y+height/2]);


/* -- ADD_COMPONENTS -- */
let IC1 = board.add(FT230XS, {translate: pt(x+width/2.0, y+.7), name: 'IC1\nFT230XS'});
let C1 = board.add(C_1206, {translate: pt(IC1.padX("CB3")+.1, IC1.posY), rotate: 90, name: 'C1\n1uF'});
let J1 = board.add(USB_A_plug, {translate: pt(IC1.posX, y+.29), rotate: -90, name: 'J1 USB\n'});
let R1 = board.add(R_1206, {translate: pt(IC1.posX+.05, IC1.posY-.22), rotate: 90, name: 'R1\n49'});
let R2 = board.add(R_1206, {translate: pt(IC1.posX-.05, R1.posY), rotate: 90, name: 'R2\n49'});
let C2 = board.add(C_1206, {translate: pt(J1.padX("5V")+.065, R1.posY), name: 'C2\n10pF'});
let C3 = board.add(C_1206, {translate: pt(J1.padX("GND")-.065, R1.posY), name: 'C3\n10pF'});
let J2 = board.add(header_UPDI_reverse, {translate: pt(IC1.posX, y+height-.23), rotate: -90, name: 'J2\nUPDI'});
let R3 = board.add(R_1206, {translate: pt(IC1.padX("TXD")-.1, IC1.padY("TXD")+.05), rotate: 90, name: 'R3\n4.99k'});

geo.difference(interior, geo.rotate(geo.translate(geo.rectangle(1.05, 9.76), [0.475+J1.posX, 5.12+J1.posY]), -90.00000001, J1.pos));
geo.difference(interior, geo.rotate(geo.translate(geo.rectangle(1.05, 9.76), [0.475+J1.posX, -5.12+J1.posY]), -90.00000001, J1.pos));

board.addShape("interior", interior);


/* -- ADD_WIRES -- */
board.wire([IC1.pad("RTS"),
            pt(IC1.padX("RTS")+.07, IC1.padY("RTS"))], w);

board.wire([IC1.pad("RXD"),
            pt(IC1.padX("RXD")+.07, IC1.padY("RXD"))], w);

board.wire([IC1.pad("GND1"),
            pt(IC1.padX("GND1")+.07, IC1.padY("GND1"))], w);

board.wire([IC1.pad("CTS"),
            pt(IC1.padX("CTS")+.07, IC1.padY("CTS"))], w);

board.wire([IC1.pad("CB2"),
            pt(IC1.padX("CB2")+.07, IC1.padY("CB2"))], w);

board.wire([IC1.pad("VCC"),
            pt(IC1.padX("VCC")-.07, IC1.padY("VCC"))], w);

board.wire([IC1.pad("GND2"),
            pt(IC1.padX("GND2")-.07, IC1.padY("GND2"))], w);

board.wire([IC1.pad("CB1"),
            pt(IC1.padX("CB1")-.07, IC1.padY("CB1"))], w);

board.wire([IC1.pad("CB0"),
            pt(IC1.padX("CB0")-.07, IC1.padY("CB0"))], w);

board.wire([IC1.pad("CB3"),
            pt(IC1.padX("CB3")-.07, IC1.padY("CB3"))], w);

board.wire([IC1.pad("VIO"),
            pt(IC1.posX, IC1.padY("VIO")),
            pt(IC1.posX, IC1.padY("3V3")),
            IC1.pad("3V3")], w);

board.wire([IC1.pad("RST"),
            pt(IC1.posX, IC1.padY("RST")),
            pt(IC1.posX, IC1.padY("3V3")),
            IC1.pad("3V3")], w);

board.wire([C1.pad("1"),
            pt(C1.posX, IC1.padY("VCC")),
            IC1.pad("VCC")], w);

board.wire([C1.pad("2"),
            pt(C1.posX, IC1.padY("GND2")),
            IC1.pad("GND2")], w);

board.wire([R1.pad("1"),
            pt(J1.padX("D-"), R1.padY("1")),
            J1.pad("D-")], w1);

board.wire([R1.pad("2"),
            pt(R1.posX, IC1.padY("USM")),
            IC1.pad("USM")], w);

board.wire([R2.pad("1"),
            pt(J1.padX("D+"), R2.padY("1")),
            J1.pad("D+")], w1);

board.wire([R2.pad("2"),
            pt(R2.posX, IC1.padY("USP")),
            IC1.pad("USP")], w);

board.wire([C2.pad("1"),
            R1.pad("1")], w1);

board.wire([J1.pad("5V"),
            pt(J1.padX("5V"), J1.posY+.05),
            pt(C2.posX, J1.posY+.12),
            pt(C2.posX, C1.padY("1")),
            C1.pad("1")], w1);

board.wire([C1.pad("2"),
            pt(C1.posX+.06, C1.padY("2")),
            pt(C1.posX+.06, C2.padY("2"))], w);

board.wire([C3.pad("2"),
            R2.pad("1")], w1);

board.wire([C3.pad("1"),
            pt(C3.posX, C3.posY)], w1);

board.wire([J1.pad("GND"),
            pt(J1.padX("GND"), J1.posY+.05),
            pt(C3.posX, J1.posY+.12),
            pt(C3.posX, IC1.padY("GND1")-.003)], w1);

board.wire([J2.pad("GND"),
            pt(J2.padX("GND"), J2.posY+.1),
            pt(C1.posX, J2.posY+.1),
            C1.pad("2")], w1);

board.wire([R3.pad("1"),
            pt(R3.posX, IC1.padY("TXD")),
            IC1.pad("TXD")], w);

board.wire([R3.pad("2"),
            pt(IC1.padX("TXD"), R3.padY("2")),
            pt(IC1.padX("TXD"), IC1.padY("TXD")+.03),
            pt(J2.padX("UPDI"), IC1.padY("TXD")+.03),
            J2.pad("UPDI")], w1);

board.wire([IC1.pad("RXD"),
            pt(R3.posX-.06, IC1.padY("RXD")),
            pt(R3.posX-.06, R3.padY("2")),
            R3.pad("2")], w);

board.wire([IC1.pad("GND1"),
            pt(C3.posX, IC1.padY("GND1"))], w);

board.wire([pt(C3.posX, IC1.padY("GND1")-.003),
            pt(R3.posX-.09, IC1.padY("GND1")-.003),
            pt(R3.posX-.09, J2.posY+.1),
            pt(J2.padX("GND"), J2.posY+.1),
            J2.pad("GND")], w1);


// rendering
renderPCB({
  pcb: board,
  layerColors: {
    "interior": "#002d00ff",
    "B.Cu": "#ff4c007f",
    "F.Cu": "#ff8c00cc",
    "drill": "#ff3300e5",
    "padLabels": "#ffff99e5",
    "componentLabels": "#00e5e5e5",
  },
  limits: {
    x: [x-border, x+width+border],
    y: [y-border, y+height+border]
  },
  mm_per_unit: 25.4
})
